config defaults
	option syn_flood '1'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'REJECT'
	option drop_invalid '0'

config zone
	option name 'wan'
	option masq '1'
	option network 'wan'
	option forward 'REJECT'
	option output 'ACCEPT'
	option local_restrict '1'
	option input 'ACCEPT'

config rule
	option name 'Allow-DHCP-Renew'
	option src 'wan'
	option proto 'udp'
	option dest_port '68'
	option target 'ACCEPT'
	option family 'ipv4'

config rule
	option name 'Allow-Ping'
	option src 'wan'
	option proto 'icmp'
	option icmp_type 'echo-request'
	option family 'ipv4'
	option target 'ACCEPT'

config rule
	option name 'Allow-DHCPv6'
	option src 'wan'
	option proto 'udp'
	option src_ip 'fe80::/10'
	option src_port '547'
	option dest_ip 'fe80::/10'
	option dest_port '546'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-ICMPv6-Input'
	option src 'wan'
	option proto 'icmp'
	option icmp_type 'echo-request echo-reply destination-unreachable packet-too-big time-exceeded bad-header unknown-header-type router-solicitation neighbour-solicitation router-advertisement neighbour-advertisement'
	option limit '1000/sec'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-ICMPv6-Forward'
	option src 'wan'
	option dest '*'
	option proto 'icmp'
	option icmp_type 'echo-request echo-reply destination-unreachable packet-too-big time-exceeded bad-header unknown-header-type'
	option limit '1000/sec'
	option family 'ipv6'
	option target 'ACCEPT'

config include
	option path '/etc/firewall.user'

config zone 'zone_freifunk'
	option input 'ACCEPT'
	option forward 'REJECT'
	option name 'freifunk'
	option output 'ACCEPT'
	option device 'tnl_+'
	option network 'tunl0 mesh_zwingli wireless0 wireless1 dhcp mgmt mesh_wilgu10 mesh_f2a mesh_schreiner27 mesh_scharni mesh_scharni29 mesh_hds'

config zone 'zone_ffuplink'
	option name 'ffuplink'
	option input 'REJECT'
	option forward 'ACCEPT'
	option output 'ACCEPT'
	option network 'ffuplink'
	option masq '1'

config forwarding
	option dest 'freifunk'
	option src 'freifunk'

config rule
	option proto 'icmp'
	option target 'ACCEPT'
	option src 'freifunk'

config rule
	option dest_port '80'
	option proto 'tcp'
	option target 'ACCEPT'
	option src 'freifunk'

config rule
	option dest_port '443'
	option proto 'tcp'
	option target 'ACCEPT'
	option src 'freifunk'

config rule
	option dest_port '22'
	option proto 'tcp'
	option target 'ACCEPT'
	option src 'freifunk'

config forwarding
	option dest 'freifunk'
	option src 'wan'

config forwarding 'fwd_ff_ffuplink'
	option src 'freifunk'
	option dest 'ffuplink'
